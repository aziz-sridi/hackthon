<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Text Swap - Hate Speech Detection</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .instructions {
            background: #e8f4fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .instructions h3 {
            margin-top: 0;
            color: #1976D2;
        }
        
        .instructions ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .instructions li {
            margin: 5px 0;
        }
        
        .test-section {
            margin: 30px 0;
        }
        
        .test-section h3 {
            color: #34495e;
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #555;
        }
        
        textarea, input[type="text"] {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.3s;
            box-sizing: border-box;
        }
        
        input[type="text"] {
            min-height: auto;
            height: 40px;
        }
        
        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: #2196F3;
        }
        
        .test-inputs {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .status.info {
            background: #fff3cd;
            border-left: 4px solid #f39c12;
            color: #856404;
        }
        
        .status.success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }
        
        .status.error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            color: #721c24;
        }
        
        .example {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 12px;
            margin: 10px 0;
        }
        
        .example strong {
            color: #e74c3c;
        }
        
        code {
            background: #f1f3f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Text Swap Test - Hate Speech Detection</h1>
        <p>Test the hate speech detection and text replacement functionality</p>
        
        <div class="instructions">
            <h3>üìã Testing Instructions:</h3>
            <ol>
                <li>Make sure the <strong>backend server</strong> is running on <code>http://localhost:5000</code></li>
                <li>Make sure the <strong>extension</strong> is loaded in Chrome</li>
                <li>Type offensive text in any of the text fields below (examples provided)</li>
                <li>Wait for the <strong>HS icon</strong> to appear and show a score badge</li>
                <li>Click the <strong>HS icon</strong> to see warning and rewrite suggestions</li>
                <li>Click any <strong>green rewrite suggestion</strong> to replace the text</li>
                <li>Verify the text in the field changes to the rewrite</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h3>üìù Test Areas</h3>
            
            <div class="test-inputs">
                <div>
                    <label>1. Textarea (Most common on social media):</label>
                    <textarea placeholder="Try typing: 'You're an idiot' or 'I hate everyone'"></textarea>
                </div>
                
                <div>
                    <label>2. Text Input:</label>
                    <input type="text" placeholder="Try typing: 'You're stupid' or 'Go away loser'">
                </div>
                
                <div>
                    <label>3. ContentEditable Div:</label>
                    <div contenteditable="true" style="min-height: 100px; padding: 12px; border: 2px solid #ddd; border-radius: 8px; background: white;" aria-label="Type your message here">
                        Type here...
                    </div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üí° Test Examples</h3>
            
            <div class="example">
                <strong>Low severity (Bullying):</strong><br>
                "You're dumb" ‚Üí Should give score ~40-60, offer rewrite
            </div>
            
            <div class="example">
                <strong>Medium severity (Bullying):</strong><br>
                "You're an idiot and pathetic" ‚Üí Should give score ~60-75, offer rewrite
            </div>
            
            <div class="example">
                <strong>High severity (Bullying):</strong><br>
                "You should go kill yourself" ‚Üí Should give score ~80-95, offer rewrite
            </div>
            
            <div class="example">
                <strong>Serious hate (Sexism/Racism):</strong><br>
                "I hate all women" ‚Üí Should give score ~95, show strong warning
            </div>
            
            <div class="example">
                <strong>Safe content:</strong><br>
                "Have a nice day!" ‚Üí Should give score 0, green badge
            </div>
        </div>
        
        <div class="status info">
            <strong>üîç What to look for:</strong><br>
            ‚Ä¢ HS icon appears on the right side of input when you start typing<br>
            ‚Ä¢ Score badge updates automatically (1 second after you stop typing)<br>
            ‚Ä¢ Clicking HS icon shows detailed popup with score and suggestions<br>
            ‚Ä¢ Green rewrite boxes are clickable<br>
            ‚Ä¢ Clicking a rewrite should INSTANTLY replace your text<br>
            ‚Ä¢ The extension console (F12) should show detailed logs
        </div>
        
        <div id="connectionStatus" class="status" style="margin-top: 20px; display: none;"></div>
    </div>
    
    <script>
        // Test if extension is loaded
        console.log('üß™ Test page loaded');
        console.log('üîç Checking for extension functions...');
        
        setTimeout(() => {
            const statusDiv = document.getElementById('connectionStatus');
            
            if (window.apiClient) {
                statusDiv.className = 'status success';
                statusDiv.innerHTML = '‚úÖ <strong>Extension Loaded!</strong> apiClient is available.';
                console.log('‚úÖ window.apiClient is available:', window.apiClient);
            } else {
                statusDiv.className = 'status error';
                statusDiv.innerHTML = '‚ùå <strong>Extension Not Detected!</strong> Make sure the extension is loaded in Chrome.';
                console.error('‚ùå window.apiClient is not available');
            }
            
            if (window.getEditableText && window.setEditableText) {
                statusDiv.innerHTML += '<br>‚úÖ <strong>DOM Functions Loaded!</strong> getEditableText and setEditableText are available.';
                console.log('‚úÖ window.getEditableText:', window.getEditableText);
                console.log('‚úÖ window.setEditableText:', window.setEditableText);
            } else {
                statusDiv.innerHTML += '<br>‚ö†Ô∏è <strong>DOM Functions Missing!</strong> getEditableText or setEditableText not found.';
                console.warn('‚ö†Ô∏è DOM functions not available');
            }
            
            statusDiv.style.display = 'block';
        }, 1000);
        
        // Test backend connection
        setTimeout(async () => {
            if (window.apiClient) {
                try {
                    const connected = await window.apiClient.connect();
                    const statusDiv = document.getElementById('connectionStatus');
                    if (connected) {
                        statusDiv.innerHTML += '<br>‚úÖ <strong>Backend Connected!</strong> Server is responding at localhost:5000.';
                        console.log('‚úÖ Backend connection successful');
                    } else {
                        statusDiv.innerHTML += '<br>‚ö†Ô∏è <strong>Backend Connection Failed!</strong> Make sure the server is running.';
                        console.warn('‚ö†Ô∏è Backend connection failed');
                    }
                } catch (error) {
                    console.error('‚ùå Backend connection error:', error);
                    document.getElementById('connectionStatus').innerHTML += '<br>‚ùå <strong>Backend Error:</strong> ' + error.message;
                }
            }
        }, 2000);
    </script>
</body>
</html>
